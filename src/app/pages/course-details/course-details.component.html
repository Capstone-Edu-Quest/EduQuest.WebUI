<div class="course-details" @fadeInOut>
  <div class="course-info">
    <div class="course-name">{{ courseDetails.name }}</div>
    <div class="feedback-ctn">
      <div class="stars-number">{{ courseDetails.rating }}</div>
      <div class="stars-ctn">
        <fa-icon *ngFor="let starIcon of starsList" [icon]="starIcon"></fa-icon>
      </div>
      <a
        [routerLink]="'/feedback/' + courseDetails.id"
        class="feedbacks-number"
      >
        ({{
          "LABEL.REVIEWS_COUNT"
            | translate
              : { value: courseDetails.numberOfRating.toLocaleString() }
        }})
      </a>
      <div>·</div>
      <div>
        {{
          "LABEL.LEANERS_COUNT"
            | translate : { value: courseDetails.leanerCount.toLocaleString() }
        }}
      </div>
    </div>
    <!--  -->

    <div class="additional">
      <div class="addt">
        <i nz-icon nzType="edit"></i>
        <div class="value">
          {{
            "LABEL.LAST_UPDATED"
              | translate
                : {
                    value:
                      "SIGNATURE.DATE_FORMAT"
                      | translate : onGetCourseLastUpdate()
                  }
          }}
        </div>
      </div>
      <div class="addt">
        <i nz-icon nzType="safety-certificate"></i>
        <div class="value">
          {{ "LABEL.CERTIFIED" | translate }}
        </div>
      </div>
    </div>

    <!--  -->
    <div class="description-title">{{ "LABEL.INSTRUCTOR" | translate }}</div>
    <div class="instructor-info-wrapper">
      <app-avatar-by-name [name]="courseDetails.author.name" [size]="'50px'" />
      <div class="info">
        <a [routerLink]="'/profile/' + courseDetails.author.id" class="name">{{
          courseDetails.author.name
        }}</a>
        <div class="job-title">{{ courseDetails.author.jobTitle }}</div>
      </div>
    </div>
    <div class="instructor-statistics">
      <div
        class="stat"
        *ngFor="let stat of courseDetails.author.statistics; let i = index"
      >
        <i nz-icon nzType="{{ authorStatsIcon[i] }}"></i>
        {{ stat.label | translate : { value: stat.value } }}
      </div>
    </div>
    <div class="instructor-description">
      {{ courseDetails.author.description }}
    </div>

    <div class="description-title">{{ "LABEL.DESCRIPTION" | translate }}</div>
    <div class="description-content">{{ courseDetails.description }}</div>

    <div class="requirements-title">{{ "LABEL.REQUIREMENTS" | translate }}</div>
    <div class="requirements">
      <div class="req-item" *ngFor="let req of courseDetails.requirements">
        <i nz-icon nzType="exclamation-circle"></i>{{ req }}
      </div>
    </div>

    <div class="description-title">{{ "LABEL.STAGES" | translate }}</div>
    <div class="sections-ctn">
      <app-course-section
        *ngFor="let stage of courseDetails.stages; let i = index"
        [index]="i"
        [stage]="stage"
      ></app-course-section>
    </div>

    <div class="description-title">{{ "LABEL.REVIEW" | translate }}</div>
    <div class="rating-stat">
      <div class="rating">
        {{ courseDetails.rating }} <fa-icon [icon]="star"></fa-icon>
      </div>
      <div>·</div>
      <div class="reviews-number">
        {{
          "LABEL.REVIEWS_COUNT"
            | translate
              : { value: courseDetails.numberOfRating.toLocaleString() }
        }}
      </div>
    </div>
  </div>

  <ng-container [ngTemplateOutlet]="floatingContent"></ng-container>
</div>

<ng-template #floatingContent>
  <div
    class="floating-course-details"
    [ngStyle]="{
      top: rightPricePosition + 'px'
    }"
  >
    <div class="info-card">
      <div class="image-wrapper">
        <img [src]="courseDetails.image" />
      </div>

      <div class="price">
        <div class="final">
          {{
            "SIGNATURE.MONEY_VALUE"
              | translate
                : {
                    value:
                      courseDetails.price * (1 - discountAmount / 100)
                      | currencyExchange
                  }
          }}
        </div>
        <div class="original" *ngIf="discountAmount > 0">
          {{
            "SIGNATURE.MONEY_VALUE"
              | translate : { value: courseDetails.price | currencyExchange }
          }}
        </div>
      </div>

      <div class="add-to-cart-group">
        <app-button
          [ngStyle]="{ width: 'calc(100%)' }"
          [type]="'primary'"
          [style]="{ width: '100%' }"
          (click)="onAddToCart($event)"
          >{{
            (isInCart ? "BUTTON.GO_TO_CART" : "BUTTON.ADD_TO_CART") | translate
          }}</app-button
        >
        <i nz-icon
          nzType="heart"
          [ngClass]="{ favorited: isInWishlist }"
          [nzTheme]="isInWishlist ? 'fill' : 'outline'"
          (click)="onAddToWishlist($event)"
          *ngIf="!isInCart"
        ></i>
      </div>

      <div class="included-title">
        {{ "LABEL.COURSE_INCLUDED" | translate }}
      </div>
      <div class="guarantees-ctn">
        <div class="guarantee" *ngFor="let guarantee of guaranteeItems">
          <i nz-icon nzType="{{ guarantee.icon }}"></i>
          <label>{{
            guarantee.label | translate : { value: guarantee.value }
          }}</label>
        </div>
      </div>

      <!--  -->
      <div class="included-title">
        {{ "LABEL.COUPON" | translate }}
      </div>

      <div class="coupon" *ngIf="_coupon && _coupon.code">
        <div class="info">
          <div class="code">
            <b>{{ _coupon.code }}</b>
            {{ "LABEL.CODE_IS_APPLIED" | translate }}
          </div>
          <div class="discount">-{{ _coupon?.discount ?? 0 }}%</div>
        </div>
        <i nz-icon nzType="close" (click)="removeCoupon()"></i>
      </div>

      <div class="input-code">
        <input
          [(ngModel)]="inputCoupon"
          placeholder="{{ 'LABEL.ENTER_CODE' | translate }}"
          (keydown)="onPressEnterCoupon($event)"
        />
        <app-button
          [type]="'primary'"
          [ngStyle]="{ width: '200px' }"
          [style]="{ width: '100%' }"
          (click)="applyNewCoupon()"
          >{{ "BUTTON.APPLY" | translate }}</app-button
        >
      </div>
    </div>
  </div>
</ng-template>
